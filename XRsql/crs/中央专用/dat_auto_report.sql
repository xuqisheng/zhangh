-- 系统报表
DELETE FROM auto_dept WHERE code = 'CZ'
;
INSERT INTO auto_dept ( code, descript, descript1 ) VALUES ( 'CZ', '中央预订报表', 'CRS Report' ) 
;
DELETE FROM auto_report WHERE dept = 'CZ'
;
INSERT INTO auto_report ( dept, wtype, id, descript, descript1, allowmodus, source ) VALUES ( 'CZ', 'tab', 'rep!REP!MRS', '月度订房量统计--按成员酒店', 'MONTH RESERVERATION STATISTICS BY MEM', '02#@100@', '_com_p_月度订房量统计--按成员店;(select b.hotelid,char301  =  h.descript,numb081  =  sum(a.gstno),numb082  =  sum(a.rmnum),numb083  =  sum(a.rmnum)*sum(a.i_days),mone101  =  sum(a.tl) ,mone102  =  sum(a.tl)/(sum(a.rmnum)*sum(a.i_days)) from guest_income a, vhmaster b ,hotelinfo h where b.accnt0 = a.accnt and b.hotelid = h.hotelid  and convert(char(4),datepart(yy,b.cotime))+''/''+ substring(convert(char(3),datepart(mm,b.cotime) + 100),2,2)  = substring(''#char079!请输入月份，格式 2004/01!2005/06#'',1,7)  group by b.hotelid,h.descript order by b.hotelid);char301:酒店名称=30;numb081:人数;numb082:房数;numb083:间天数;mone101:收入;mone102:平均房价headerds=[header=4 summary=1 player=3 autoappe=0 ]computes=s_1: sum(numb081 for all) :summary:1::numb081:numb081::alignment="1"!computes=s_2: sum(numb082 for all) :summary:1::numb082:numb082::alignment="1"!computes=s_3: sum(numb083 for all) :summary:1::numb083:numb083::alignment="1"!computes=s_4: sum(mone101 for all) :summary:1::mone101:mone101::alignment="1" format="0.00"!computes=s_5: sum(mone102 for all) :summary:1::mone102:mone102::alignment="1" format="0.00"!computes=s_b:''总计'':summary:1::char301:char301::alignment="2"!computes=p_yshu:''页次('' + string(page(),''0'')+''/''+string(pagecount(),''0)''):header:3::char101:char160::alignment="2"  border="0"!texttext=t_time: #char079# :header:3::mone101:mone102::alignment="2"  border="0" texttext=t_title:月度订房量统计--按成员店:header:1::char301:mone102::alignment="2" font.height="-12" border="0"!' ) 
INSERT INTO auto_report ( dept, wtype, id, descript, descript1, allowmodus, source ) VALUES ( 'CZ', 'tab', 'rep!REP!MRSBYEMP', '月度订房量统计--按预订员', 'MONTH RESERVERATION STATISTICS BY EMP', '02#@100@', '_com_p_月度订房量统计--按预订员;(select char101  =  b.resby,char160  =  s.name,b.hotelid,char301  =  h.descript,numb081  =  sum(a.gstno),numb082  =  sum(a.rmnum),numb083  =  sum(a.rmnum)*sum(a.i_days),mone101  =  sum(a.tl) ,mone102  =  sum(a.tl)/(sum(a.rmnum)*sum(a.i_days)) from guest_income a, vhmaster b ,hotelinfo h,sys_empno s where b.accnt = a.accnt and b.hotelid = h.hotelid and b.resby = s.empno and convert(char(4),datepart(yy,b.restime))+''/''+ substring(convert(char(3),datepart(mm,b.restime) + 100),2,2)  = substring(''#char079!请输入月份，格式 2004/01!2005/06#'',1,7)  group by b.resby,s.name,b.hotelid,h.descript having sum(a.rmnum)*sum(a.i_days) > 0 union select char101  =  b.resby,char160  =  s.name,b.hotelid,char301  =  h.descript,numb081  =  sum(a.gstno),numb082  =  sum(a.rmnum),numb083  =  sum(a.rmnum)*sum(a.i_days),mone101  =  sum(a.tl) ,mone102  =  0 from guest_income a, vhmaster b ,hotelinfo h,sys_empno s where b.accnt = a.accnt and b.hotelid = h.hotelid and b.resby = s.empno and convert(char(4),datepart(yy,b.restime))+''/''+ substring(convert(char(3),datepart(mm,b.restime) + 100),2,2)  = substring(''#char079#'',1,7)  group by b.resby,s.name,b.hotelid,h.descript having sum(a.rmnum)*sum(a.i_days) = 0 union select char101  =  b.resby,char160  =  s.name,b.hotelid,char301  =  h.descript,numb081  =  sum(b.gstno),numb082  =  sum(b.rmnum),numb083  =  0,mone101  =  0 ,mone102  =  0 from vmaster b ,hotelinfo h,sys_empno s where b.hotelid = h.hotelid and b.resby = s.empno and convert(char(4),datepart(yy,b.restime))+''/''+ substring(convert(char(3),datepart(mm,b.restime) + 100),2,2)  = substring(''#char079#'',1,7)  group by b.resby,s.name,b.hotelid,h.descript order by b.resby,b.hotelid);char101:工号;char160:预订员=10;char301:酒店名称=30;numb081:人数;numb082:房数;numb083:间天数;mone101:收入;mone102:平均房价headerds=[header=4 summary=1 player=3 autoappe=0 ]group_by=1:0:1:("char101")computes=c_1: sum(numb081 for group 1) :trailer.1:1::numb081:numb081::alignment="1"!computes=c_2: sum(numb082 for group 1) :trailer.1:1::numb082:numb082::alignment="1"!computes=c_3: sum(numb083 for group 1) :trailer.1:1::numb083:numb083::alignment="1"!computes=c_4: sum(mone101 for group 1) :trailer.1:1::mone101:mone101::alignment="1" format="0.00"!computes=c_5: sum(mone102 for group 1) :trailer.1:1::mone102:mone102::alignment="1" format="0.00"!computes=c_b:''小计'':trailer.1:1::char101:char301::alignment="2"!computes=s_1: sum(numb081 for all) :summary:1::numb081:numb081::alignment="1"!computes=s_2: sum(numb082 for all) :summary:1::numb082:numb082::alignment="1"!computes=s_3: sum(numb083 for all) :summary:1::numb083:numb083::alignment="1"!computes=s_4: sum(mone101 for all) :summary:1::mone101:mone101::alignment="1" format="0.00"!computes=s_5: sum(mone102 for all) :summary:1::mone102:mone102::alignment="1" format="0.00"!computes=s_b:''总计'':summary:1::char101:char301::alignment="2"!computes=p_yshu:''页次('' + string(page(),''0'')+''/''+string(pagecount(),''0)''):header:3::char101:char160::alignment="2"  border="0"!texttext=t_time: #char079# :header:3::mone101:mone102::alignment="2"  border="0" texttext=t_title:月度订房量统计--按预订员:header:1::char101:mone102::alignment="2" font.height="-12" border="0"!	1	2' ) 
INSERT INTO auto_report ( dept, wtype, id, descript, descript1, allowmodus, source ) VALUES ( 'CZ', 'tab', 'rep!REP!MRSSOURCE', '月度订房量统计--按来源', 'MONTH RESERVERATION STATISTICS BY SRC', '02#@100@', '_com_p_月度订房量统计--按来源;(select char101  =  b.src,char160  =  s.descript,b.hotelid,char301  =  h.descript,numb081  =  sum(a.gstno),numb082  =  sum(a.rmnum),numb083  =  sum(a.rmnum)*sum(a.i_days),mone101  =  sum(a.tl) ,mone102  =  sum(a.tl)/(sum(a.rmnum)*sum(a.i_days)) from guest_income a, vhmaster b ,hotelinfo h,srccode s where b.accnt0 = a.accnt and b.hotelid = h.hotelid and b.src = s.code and convert(char(4),datepart(yy,b.cotime))+''/''+ substring(convert(char(3),datepart(mm,b.cotime) + 100),2,2)  = substring(''#char079!请输入月份，格式 2004/01!2005/06#'',1,7)  group by b.src,s.descript,b.hotelid,h.descript order by b.src,b.hotelid);char101:来源;char160:来源名称=16;char301:酒店名称=30;numb081:人数;numb082:房数;numb083:间天数;mone101:收入;mone102:平均房价headerds=[header=4 summary=1 player=3 autoappe=0 ]group_by=1:0:1:("char101")computes=c_1: sum(numb081 for group 1) :trailer.1:1::numb081:numb081::alignment="1"!computes=c_2: sum(numb082 for group 1) :trailer.1:1::numb082:numb082::alignment="1"!computes=c_3: sum(numb083 for group 1) :trailer.1:1::numb083:numb083::alignment="1"!computes=c_4: sum(mone101 for group 1) :trailer.1:1::mone101:mone101::alignment="1"  format="0.00"!computes=c_5: sum(mone102 for group 1) :trailer.1:1::mone102:mone102::alignment="1" format="0.00"!computes=c_b:''小计'':trailer.1:1::char101:char301::alignment="2"!computes=s_1: sum(numb081 for all) :summary:1::numb081:numb081::alignment="1"!computes=s_2: sum(numb082 for all) :summary:1::numb082:numb082::alignment="1"!computes=s_3: sum(numb083 for all) :summary:1::numb083:numb083::alignment="1"!computes=s_4: sum(mone101 for all) :summary:1::mone101:mone101::alignment="1" format="0.00"!computes=s_5: sum(mone102 for all) :summary:1::mone102:mone102::alignment="1" format="0.00"!computes=s_b:''总计'':summary:1::char101:char301::alignment="2"!computes=p_yshu:''页次('' + string(page(),''0'')+''/''+string(pagecount(),''0)''):header:3::char101:char160::alignment="2"  border="0"!texttext=t_time: #char079# :header:3::mone101:mone102::alignment="2"  border="0" texttext=t_title:月度订房量统计--按来源:header:1::char101:mone102::alignment="2" font.height="-12" border="0"!	1	2' ) 
INSERT INTO auto_report ( dept, wtype, id, descript, descript1, allowmodus, source ) VALUES ( 'CZ', 'tab', 'rep!REP!RSVRPT', '月度预订报表', 'MONTH RESERVERATION REPORT', '02#@100@', '_com_p_月度预订报表;(select a.hotelid,char60  =  substring(h.descript,  1,  60),a.accnt,a.rmnum,a.roomno,a.gstno,b.name,a.sta,char012  =  substring(a.extra,  4,  1),char013  =  substring(a.extra,  5,  1),char031  =  b.vip,b.i_times,a.type,a.arr,a.dep,a.ref,c.cusno,c.agent,c.source,c.groupno,mone100  =  a.charge-a.credit,a.setrate,a.resno,a.packages,b.refer1 from vmaster a, guest b, master_des c, hotelinfo h  where a.haccnt=b.no and a.class in (''F'',  ''G'',  ''M'') and a.accnt *=c.accnt and a.hotelid = h.hotelid and convert(char(4),datepart(yy,restime))+''/''+ substring(convert(char(3),datepart(mm,restime) + 100),2,2)  =  substring(''#char079!请输入月份，格式 2004/01!2004/09#'',1,7) union select a.hotelid,char60  =  substring(h.descript,  1,  60),a.accnt,a.rmnum,a.roomno,a.gstno,b.name,a.sta,char012  =  substring(a.extra,  4,  1),char013  =  substring(a.extra,  5,  1),char031  =  b.vip,b.i_times,a.type,a.arr,a.dep,a.ref,c.cusno,c.agent,c.source,c.groupno,mone100  =  a.charge-a.credit,a.setrate,a.resno,a.packages,b.refer1 from vhmaster a, guest b, master_des c, hotelinfo h  where a.haccnt=b.no and a.class in (''F'',  ''G'',  ''M'') and a.accnt *=c.accnt and a.hotelid = h.hotelid and convert(char(4),datepart(yy,restime))+''/''+ substring(convert(char(3),datepart(mm,restime) + 100),2,2)  =  substring(''#char079#'',1,7) );char60:酒店=15;a.accnt:帐号=10;b.name:姓名=10;a.sta:STA;b.i_times:次数=3;a.type:房类;a.rmnum:房数=3=0=alignment="2";a.roomno:房号=3=[general];a.gstno:人数=4=0=alignment="2";a.setrate:房价=6=0.00=color="0~tif(nodispchar013=''1'',255,0)";a.arr:ARR=13=yy/mm/dd hh|mm=alignment=''2'';a.dep:DEP=13=yy/mm/dd hh|mm=alignment=''2'';c.groupno:团体会议=12;mone100:余额=8=0.00=color="0~tif(mone100>0,255,0)";a.resno:预订号=9=[general]=alignment=''2'';a.packages:包价=12;c.cusno:单位=16;c.agent:旅行社=16;c.source:订房中心=16;b.refer1:喜好=20;a.ref:备注=30headerds=[header=4 footer=2 player=3 autoappe=0]computes=p_yshu:''页次('' + string(page(),''0'')+''/''+string(pagecount(),''0)''):header:3::a.ref:a.ref::alignment="2"!computes=c_fshu:sum( a.rmnum * if( a.roomno ='''',  1,  0))+count( a.roomno for all distinct ) - if((sum( a.rmnum * if( a.roomno ='''',  1,  0)))>0,  1,  0):footer:1::a.rmnum:a.rmnum::alignment="2"!computes=c_rshu:sum( a.gstno ):footer:1::a.gstno:a.gstno::alignment="2"!texttext=t_title:月度预订报表:header:1::char60:a.ref::alignment="2" font.height="-12" border="0"!texttext=t_time: #char079# :header:2::char60:a.ref::alignment="2"  texttext=t_print:打印时间 #pdate#:header:3::h.descript:a.type::alignment="0"!' ) 
INSERT INTO auto_report ( dept, wtype, id, descript, descript1, allowmodus, source ) VALUES ( 'CZ', 'tab', 'rep!REP!RSVRPTBYM', '月度预订报表（某成员）', 'MONTH RESERVERATION REPORT(MEMBER)', '02#@100@', '_com_p_月度预订报表;(select a.hotelid,char60  =  substring(h.descript,  1,  60),a.accnt,a.rmnum,a.roomno,a.gstno,b.name,a.sta,char012  =  substring(a.extra,  4,  1),char013  =  substring(a.extra,  5,  1),char031  =  b.vip,b.i_times,a.type,a.arr,a.dep,a.ref,c.cusno,c.agent,c.source,c.groupno,mone100  =  a.charge-a.credit,a.setrate,a.resno,a.packages,b.refer1 from vmaster a, guest b, master_des c, hotelinfo h  where a.haccnt=b.no and a.class in (''F'',  ''G'',  ''M'') and a.accnt *=c.accnt and a.hotelid = h.hotelid and a.hotelid  =  ''#char20!请输入成员酒店代码!<<g>>hotelinfo@@hotelid#''  and  convert(char(4),datepart(yy,restime))+''/''+ substring(convert(char(3),datepart(mm,restime) + 100),2,2)  =  substring(''#char079!请输入月份，格式 2004/01!2004/09#'',1,7) union select a.hotelid,char60  =  substring(h.descript,  1,  60),a.accnt,a.rmnum,a.roomno,a.gstno,b.name,a.sta,char012  =  substring(a.extra,  4,  1),char013  =  substring(a.extra,  5,  1),char031  =  b.vip,b.i_times,a.type,a.arr,a.dep,a.ref,c.cusno,c.agent,c.source,c.groupno,mone100  =  a.charge-a.credit,a.setrate,a.resno,a.packages,b.refer1 from vhmaster a, guest b, master_des c, hotelinfo h  where a.haccnt=b.no and a.class in (''F'',  ''G'',  ''M'') and a.accnt *=c.accnt and a.hotelid = h.hotelid and a.hotelid  =  ''#char20#''  and  convert(char(4),datepart(yy,restime))+''/''+ substring(convert(char(3),datepart(mm,restime) + 100),2,2)  =  substring(''#char079#'',1,7) );a.accnt:帐号=10;b.name:姓名=10;a.sta:STA;b.i_times:次数=3;a.type:房类;a.rmnum:房数=3=0=alignment="2";a.roomno:房号=3=[general];a.gstno:人数=4=0=alignment="2";a.setrate:房价=6=0.00=color="0~tif(nodispchar013=''1'',255,0)";a.arr:ARR=13=yy/mm/dd hh|mm=alignment=''2'';a.dep:DEP=13=yy/mm/dd hh|mm=alignment=''2'';c.groupno:团体会议=12;mone100:余额=8=0.00=color="0~tif(mone100>0,255,0)";a.resno:预订号=9=[general]=alignment=''2'';a.packages:包价=12;c.cusno:单位=16;c.agent:旅行社=16;c.source:订房中心=16;b.refer1:喜好=20;a.ref:备注=30headerds=[header=4 footer=2 player=3 autoappe=0]computes=c_fshu:sum( a.rmnum * if( a.roomno ='''',  1,  0))+count( a.roomno for all distinct ) - if((sum( a.rmnum * if( a.roomno ='''',  1,  0)))>0,  1,  0):footer:1::a.rmnum:a.rmnum::alignment="2" border="0"!computes=c_rshu:sum( a.gstno ):footer:1::a.gstno:a.gstno::alignment="2" border="0"!computes=p_yshu:''页次('' + string(page(),''0'')+''/''+string(pagecount(),''0)''):header:3::a.ref:a.ref::alignment="2" border="0"!computes=c_hotel: char60 :header:2::a.accnt:a.ref::alignment="2" border="0"!texttext=t_title:月度预订报表:header:1::a.accnt:a.ref::alignment="2" font.height="-12" border="0"!texttext=t_time: #char079# :header:3::a.accnt:a.ref::alignment="2" border="0"!  texttext=t_print:打印时间 #pdate#:header:3::a.accnt:a.type::alignment="0" border="0"!' ) 
INSERT INTO auto_report ( dept, wtype, id, descript, descript1, allowmodus, source ) VALUES ( 'CZ', 'tab', 'rep!REP!RSVRPTGRPM', '月度预订报表(成员分组)', 'MONTH RESERVERATION REPORT(GRP BY MEM)', '02#@100@', '_com_p_月度预订报表(成员分组);(select a.hotelid,char60  =  substring(h.descript,  1,  60),a.accnt,a.rmnum,a.roomno,a.gstno,b.name,a.sta,char012  =  substring(a.extra,  4,  1),char013  =  substring(a.extra,  5,  1),char031  =  b.vip,b.i_times,a.type,a.arr,a.dep,a.ref,c.cusno,c.agent,c.source,c.groupno,mone100  =  a.charge-a.credit,a.setrate,a.resno,a.packages,b.refer1 from vmaster a, guest b, master_des c, hotelinfo h  where a.haccnt=b.no and a.class in (''F'',  ''G'',  ''M'') and a.accnt *=c.accnt and a.hotelid = h.hotelid and convert(char(4),datepart(yy,restime))+''/''+ substring(convert(char(3),datepart(mm,restime) + 100),2,2)  =  substring(''#char079!请输入月份，格式 2004/01!2004/09#'',1,7) union select a.hotelid,char60  =  substring(h.descript,  1,  60),a.accnt,a.rmnum,a.roomno,a.gstno,b.name,a.sta,char012  =  substring(a.extra,  4,  1),char013  =  substring(a.extra,  5,  1),char031  =  b.vip,b.i_times,a.type,a.arr,a.dep,a.ref,c.cusno,c.agent,c.source,c.groupno,mone100  =  a.charge-a.credit,a.setrate,a.resno,a.packages,b.refer1 from vhmaster a, guest b, master_des c, hotelinfo h  where a.haccnt=b.no and a.class in (''F'',  ''G'',  ''M'') and a.accnt *=c.accnt and a.hotelid = h.hotelid and convert(char(4),datepart(yy,restime))+''/''+ substring(convert(char(3),datepart(mm,restime) + 100),2,2)  =  substring(''#char079#'',1,7)  order by a.hotelid);a.accnt:帐号=10;b.name:姓名=10;a.sta:STA;b.i_times:次数=3;a.type:房类;a.rmnum:房数=3=0=alignment="2";a.roomno:房号=3=[general];a.gstno:人数=4=0=alignment="2";a.setrate:房价=6=0.00=color="0~tif(nodispchar013=''1'',255,0)";a.arr:ARR=13=yy/mm/dd hh|mm=alignment=''2'';a.dep:DEP=13=yy/mm/dd hh|mm=alignment=''2'';c.groupno:团体会议=12;mone100:余额=8=0.00=color="0~tif(mone100>0,255,0)";a.resno:预订号=9=[general]=alignment=''2'';a.packages:包价=12;c.cusno:单位=16;c.agent:旅行社=16;c.source:订房中心=16;b.refer1:喜好=20;a.ref:备注=30headerds=[header=4 summary=1 player=3 autoappe=0 ]group_by=1:1:1:("a.hotelid")computes=c_b1:'''':trailer.1:1::a.accnt:a.ref::alignment="0"!computes=c_fs1:sum( a.rmnum * if( a.roomno ='''',  1,  0))+count( a.roomno for all distinct ) - if((sum( a.rmnum * if( a.roomno ='''',  1,  0))  for  group 1)>0,  1,  0):trailer.1:1::a.rmnum:a.rmnum::alignment="2"!computes=c_rs1:sum( a.gstno   for  group 1):trailer.1:1::a.gstno:a.gstno::alignment="2"!computes=c_n1:char60:header.1:1::a.accnt:b.name::alignment="2"!computes=c_b:''总计'':summary:1::a.accnt:a.ref::alignment="0"!computes=c_fshu:sum( a.rmnum * if( a.roomno ='''',  1,  0))+count( a.roomno for all distinct ) - if((sum( a.rmnum * if( a.roomno ='''',  1,  0)))>0,  1,  0):summary:1::a.rmnum:a.rmnum::alignment="2"!computes=c_rshu:sum( a.gstno ):summary:1::a.gstno:a.gstno::alignment="2"!computes=p_yshu:''页次('' + string(page(),''0'')+''/''+string(pagecount(),''0)''):header:3::a.ref:a.ref::alignment="2"  border="0"!texttext=t_title:月度预订报表(成员分组):header:1::a.accnt:a.ref::alignment="2" font.height="-12" border="0"!texttext=t_time: #char079# :header:2::a.accnt:a.ref::alignment="2"  border="0"  texttext=t_print:打印时间 #pdate#:header:3::a.accnt:a.type::alignment="0"  border="0"!' ) 
INSERT INTO auto_report ( dept, wtype, id, descript, descript1, allowmodus, source ) VALUES ( 'CZ', 'tab', 'rep!REP!RSVRPTGRPSRC', '月度预订报表(来源分组)', 'MONTH RESERVERATION REPORT(GRP BY SRC)', '02#@100@', '_com_p_月度预订报表(来源分组);(select a.hotelid,char60  =  substring(h.descript,  1,  60),a.accnt,a.rmnum,a.roomno,a.gstno,b.name,a.sta,char012  =  substring(a.extra,  4,  1),char013  =  substring(a.extra,  5,  1),char031  =  b.vip,b.i_times,a.type,a.arr,a.dep,a.ref,c.cusno,c.agent,c.source,c.groupno,mone100  =  a.charge-a.credit,a.setrate,a.resno,a.packages,b.refer1,char039  =  substring(exp_s3,  5,  3)  from vmaster a, guest b, master_des c, hotelinfo h  where a.haccnt=b.no and a.class in (''F'',  ''G'',  ''M'') and a.accnt *=c.accnt and a.hotelid = h.hotelid and convert(char(4),datepart(yy,restime))+''/''+ substring(convert(char(3),datepart(mm,restime) + 100),2,2)  =  substring(''#char079!请输入月份，格式 2004/01!2004/09#'',1,7) union select a.hotelid,char60  =  substring(h.descript,  1,  60),a.accnt,a.rmnum,a.roomno,a.gstno,b.name,a.sta,char012  =  substring(a.extra,  4,  1),char013  =  substring(a.extra,  5,  1),char031  =  b.vip,b.i_times,a.type,a.arr,a.dep,a.ref,c.cusno,c.agent,c.source,c.groupno,mone100  =  a.charge-a.credit,a.setrate,a.resno,a.packages,b.refer1,char039  =  substring(exp_s3,  5,  3) from vhmaster a, guest b, master_des c, hotelinfo h  where a.haccnt=b.no and a.class in (''F'',  ''G'',  ''M'') and a.accnt *=c.accnt and a.hotelid = h.hotelid and convert(char(4),datepart(yy,restime))+''/''+ substring(convert(char(3),datepart(mm,restime) + 100),2,2)  =  substring(''#char079#'',1,7)  order by char039);char60:酒店=15;a.accnt:帐号=10;b.name:姓名=10;a.sta:STA;b.i_times:次数=3;a.type:房类;a.rmnum:房数=3=0=alignment="2";a.roomno:房号=3=[general];a.gstno:人数=4=0=alignment="2";a.setrate:房价=6=0.00=color="0~tif(nodispchar013=''1'',255,0)";a.arr:ARR=13=yy/mm/dd hh|mm=alignment=''2'';a.dep:DEP=13=yy/mm/dd hh|mm=alignment=''2'';c.groupno:团体会议=12;mone100:余额=8=0.00=color="0~tif(mone100>0,255,0)";a.resno:预订号=9=[general]=alignment=''2'';a.packages:包价=12;c.cusno:单位=16;c.agent:旅行社=16;c.source:订房中心=16;b.refer1:喜好=20;a.ref:备注=30headerds=[header=4 summary=1 player=3 autoappe=1]group_by=1:1:1:("char039")computes=c_fs1:sum( a.rmnum * if( a.roomno ='''',  1,  0) for group 1)+count( a.roomno for group 1 distinct ) - if((sum( a.rmnum * if( a.roomno ='''',  1,  0) for group 1))>0,  1,  0):trailer.1:1::a.rmnum:a.rmnum::alignment="2"  border="0"!computes=c_rs1:sum( a.gstno for group 1):trailer.1:1::a.gstno:a.gstno::alignment="2"  border="0"!computes=c_n1: char039 :header.1:1::char60:char60::alignment="2"  border="0"!computes=c_fshu:sum( a.rmnum * if( a.roomno ='''',  1,  0))+count( a.roomno for all distinct ) - if((sum( a.rmnum * if( a.roomno ='''',  1,  0)))>0,  1,  0):summary:1::a.rmnum:a.rmnum::alignment="2"  border="0"!computes=c_rshu:sum( a.gstno ):summary:1::a.gstno:a.gstno::alignment="2"  border="0"!computes=p_yshu:''页次('' + string(page(),''0'')+''/''+string(pagecount(),''0)''):header:3::a.ref:a.ref::alignment="2"  border="0"!texttext=t_title:月度预订报表(来源分组):header:1::char60:a.ref::alignment="2" font.height="-12" border="0"!texttext=t_time: #char079# :header:2::char60:a.ref::alignment="2" border="0" !texttext=t_print:打印时间 #pdate#:header:3::char60:a.type::alignment="0"  border="0"!' ) 
;
