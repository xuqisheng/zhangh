delete from workselect where modu_id = '00' and window = 'w_gds_master_list_res'
;

INSERT INTO workselect ( modu_id, window, descript, descript1, colsele, coldes, colsta, colkey, genput, usedef, openflash ) VALUES ( '00', 'w_gds_master_list_res', '当前预订列表', '当前预订列表_eng', 'select rslt10  =  a.accnt,a.accnt,a.rmnum,a.roomno,a.gstno,b.name,b.name2,a.sta,char012  =  substring(a.extra,  4,  1),char013  =  substring(a.extra,  5,  1),char011  =  b.vip,numb081  =  (SELECT count(1) FROM message_leaveword WHERE sort = ''LWD'' And accnt=a.accnt And tag<''2''),numb082  =  (SELECT count(1) FROM message_leaveword WHERE sort = ''LOC'' And accnt=a.accnt And tag=''1'' and datediff(second,  message_leaveword.abate,  getdate()) < 0),char01  =  substring(a.extra,  10,  1),b.i_times,a.type,a.arr,a.dep,a.ref,char991  =  c.groupno+''/''+c.cusno+''/''+substring(c.unit,  1,  20),char992  =  c.agent+''/''+c.source,mone100  =  a.charge-a.credit,a.setrate,a.resno,a.packages,char15  =  a.pcrec,b.refer1 from master a,guest b,master_des c  where a.haccnt=b.no and a.class in (''F'',  ''G'',  ''M'') and a.accnt=c.accnt  and a.crsno like ''CRS:%'' and (1=1) order by a.arr,a.sta', 'a.roomno:房号=3=[general];a.type:房类;a.rmnum:#=2=0=alignment="2";b.name:姓名=10;b.name2:姓名2=10;a.sta:Sta;char01_1=='''':-;char01_2=='''':-;char01_3=='''':-;char01_4=='''':-;char01_5=='''':-;char01_6=='''':-;b.i_times:次数=3=0=alignment="2";a.gstno:人数=3=0=alignment="2";a.setrate:房价=6=0.00=color="0~tif(nodispchar013=''1'',255,0)";a.packages:包价=7;a.arr:到达=13=yy/mm/dd hh|mm=alignment=''2'';a.dep:离开=13=yy/mm/dd hh|mm=alignment=''2'';a.resno:预订号=9=[general]=alignment=''2'';mone100:余额=8=0.00=color="0~tif(mone100>0,255,0)";char991:团体/单位=26;char992:旅行社/订房中心=26;b.refer1:喜好=20;a.ref:备注=30;a.accnt:帐号=10headerds=[footer=1 autoappe=0]computes=c_fshu:( sum( a_rmnum2 * if( a_roomno3 ='''', 1, 0))+count( a_roomno3 for all distinct ) - if((sum( a_rmnum2 * if( a_roomno3 ='''', 1, 0)))>0, 1, 0) ):footer:1::a.type:a.type::alignment="2"!computes=c_rshu:( sum( a_gstno4) ):footer:1::a.gstno:a.gstno::alignment="2"!texttext=r_vip:●:detail:1::char01_1:char01_1::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-13" color="255" visible="0~tif(nodispchar011>''0'',1,0)"!texttext=r_srt:●:detail:1::char01_2:char01_2::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-13" color="16711935" visible="1~tif(nodispchar012>''0'',1,0)"!texttext=r_msg:●:detail:1::char01_3:char01_3::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-13" color="16711680" visible="1~tif(nodispnumb081>0,1,0)"!texttext=r_link:●:detail:1::char01_4:char01_4::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-13" color="65535" visible="1~tif(trim(nodispchar15)<>'''',1,0)"!texttext=r_fwd:●:detail:1::char01_5:char01_5::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-13" color="8388608" visible="1~tif(nodispnumb082>0,1,0)"!texttext=r_lock:●:detail:1::char01_6:char01_6::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-13" color="65280~tif(nodispchar01=''1'',65280,if(nodispchar01=''2'',32768,0))" visible="1~tif(nodispchar01=''0'',0,1)"!', 'a.sta', 'rslt10', '_com_p_当前宾客信息列表;(select a.accnt,a.rmnum,a.roomno,a.gstno,b.name,a.sta,char012  =  substring(a.extra,  4,  1),char013  =  substring(a.extra,  5,  1),char011  =  b.vip,numb081  =  (Select count(1) From message_leaveword Where sort = ''LWD'' And accnt=a.accnt And tag<''2''),numb082  =  (Select count(1) From message_leaveword Where sort = ''LOC'' And accnt=a.accnt And tag<''2''),numb083  =  (Select count(1) From subaccnt Where accnt=a.accnt And type=''0'' And pccodes like ''+[^0]''), b.i_times,a.type,a.arr,a.dep,a.ref,c.cusno,c.agent,c.source,c.groupno,mone100  =  a.charge-a.credit,a.setrate,a.resno,a.packages,b.refer1 from master a, guest b, master_des c  where a.haccnt=b.no and a.class in (''F'',  ''G'',  ''M'') and a.accnt=c.accnt  and a.crsno like ''CRS:%'' and (1=1));a.accnt:帐号=10;b.name:姓名=10;a.sta:STA;char01_1=='''':-;char01_2=='''':-;char01_3=='''':-;char01_4=='''':-;char01_5=='''':-;char01_6=='''':-;b.i_times:次数=3;a.type:房类;a.rmnum:房数=3=0=alignment="2";a.roomno:房号=3=[general];a.gstno:人数=4=0=alignment="2";a.setrate:房价=6=0.00=color="0~tif(nodispchar013=''1'',255,0)";a.arr:ARR=13=yy/mm/dd hh|mm=alignment=''2'';a.dep:DEP=13=yy/mm/dd hh|mm=alignment=''2'';c.groupno:团体会议=12;mone100:余额=8=0.00=color="0~tif(mone100>0,255,0)";a.resno:预订号=9=[general]=alignment=''2'';a.packages:包价=12;c.cusno:单位=16;c.agent:旅行社=16;c.source:订房中心=16;b.refer1:喜好=20;a.ref:备注=30headerds=[header=4 footer=1 player=3 autoappe=0]computes=p_yshu:''页次('' + string(page(),''0'')+''/''+string(pagecount(),''0)''):header:3::a.ref:a.ref::alignment="2"!computes=c_fshu:( sum( a_rmnum2 * if( a_roomno3 ='''', 1, 0))+count( a_roomno3 for all distinct ) - if((sum( a_rmnum2 * if( a_roomno3 ='''', 1, 0)))>0, 1, 0) ):footer:1::a.rmnum:a.rmnum::alignment="2"!computes=c_rshu:( sum( a_gstno4) ):footer:1::a.gstno:a.gstno::alignment="2"!texttext=r_vip:●:detail:1::char01_1:char01_1::alignment="2" border="0" font.italic="0" font.face="Arial" font.charset="0" font.height="-10" color="255" visible="0~tif(nodispchar011>''0'',1,0)"!texttext=r_srt:●:detail:1::char01_2:char01_2::alignment="2" border="0" font.italic="0" font.face="Arial" font.charset="0" font.height="-10" color="16711935" visible="1~tif(nodispchar012>''0'',1,0)"!texttext=r_msg:●:detail:1::char01_3:char01_3::alignment="2" border="0" font.italic="0" font.face="Arial" font.charset="0" font.height="-10" color="16711680" visible="1~tif(nodispnumb081>0,1,0)"!texttext=r_fwd:●:detail:1::char01_5:char01_5::alignment="2" border="0" font.italic="0" font.face="Arial" font.charset="0" font.height="-10" color="8388608" visible="1~tif(nodispnumb082>0,1,0)"!texttext=r_lock:●:detail:1::char01_6:char01_6::alignment="2" border="0" font.italic="0" font.face="Arial" font.charset="0" font.height="-10" color="65280" visible="1~tif(nodispnumb083=0,1,0)"!texttext=t_hotel:#hotel#:header:1::a.accnt:a.ref::alignment="2" font.height="-12" border="0"!texttext=t_title:宾客信息列表:header:2::a.accnt:a.ref::alignment="2" font.height="-12" border="0"!texttext=t_print:打印时间 #pdate#:header:3::a.accnt:a.type::alignment="0"!', 'F', 'T' ) 
;

delete from worksheet where modu_id = '00' and window = 'w_gds_master_list_res'
;

INSERT INTO worksheet ( modu_id, window, tab_no, descript, descript1, tab_tag, sequence, colsele, coldes, colsta, colkey, genput, usedef ) VALUES ( '00', 'w_gds_master_list_res', 1, '散客＆成员', 'Individual', 'a.class=''F''', 10, '', '', '', '', '_com_p_当前预定信息列表;(select a.accnt,a.sta,a.type,a.roomno,b.name,a.arr,a.dep,mone10  =  a.setrate,a.applicant,a.srqs,b.nation,a.paycode,mone12  =  a.charge - a.credit  from master a,guest b where a.haccnt=b.no and a.sta = ''R''  and a.crsno like ''CRS:%'' order by a.accnt );a.accnt:帐号=9;a.sta:状态;a.type:房类;a.roomno:房号;b.name:姓名=30;a.arr:到日=12=yy/mm/dd hh|mm;a.dep:离日=12=yy/mm/dd hh|mm;mone10:房价=8=0.00;a.applicant:单位=20;a.srqs:特要=10;b.nation:国籍;a.paycode:付款;mone12:余额=8=0.00headerds=[header=4 player=3 summary=1 styles=box]computes=p_yshu:string(page(),''0'')+''/''+string(pagecount(),''0''):header:3::mone12:mone12::border="0" alignment="2"!computes=c_fshu:count( a.accnt for all DISTINCT):summary:1::a.sta:a.type::alignment="2"!computes=c_rshu:count( a.accnt ):summary:1::a.arr:a.arr::alignment="2"!computes=c_rate:sum( mone10 for all DISTINCT a_accnt1 ):summary:1::mone10:mone10::alignment="2" format="0.00"!computes=c_bal:sum( mone12 for all DISTINCT a_accnt1 ):summary:1::mone12:mone12::alignment="2" format="0.00"!texttext=p_hotel:#hotel#:header:1::a.accnt:mone12::border="0" alignment="2" font.height="-12" font.italic="0"!texttext=p_title:当前预定信息列表:header:2::a.accnt:mone12::border="0" alignment="2" font.height="-12" font.italic="0"!texttext=p_date:打印时间 #pdate#:header:3::a.accnt:mone10::border="0" alignment="0"!texttext=p_page:页次:header:3::a.paycode:a.paycode::border="0" alignment="2"!texttext=p_fshu:房数:summary:1::a.accnt:a.accnt::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:人数:summary:1::a.roomno:b.name::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:总房价:summary:1::a.dep:a.dep::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:余额:summary:1::a.applicant:a.paycode::border="2" alignment="2" font.height="-12" font.italic="0"!', 'F' ) 
INSERT INTO worksheet ( modu_id, window, tab_no, descript, descript1, tab_tag, sequence, colsele, coldes, colsta, colkey, genput, usedef ) VALUES ( '00', 'w_gds_master_list_res', 2, '所有', 'All', '1=1', 200, '', '', '', '', '_com_p_当前预定信息列表;(select a.accnt,a.sta,a.type,a.roomno,b.name,a.arr,a.dep,mone10  =  a.setrate,a.applicant,a.srqs,b.nation,a.paycode,mone12  =  a.charge - a.credit  from master a,guest b where a.haccnt=b.no and a.sta = ''R''  and a.crsno like ''CRS:%''  );a.accnt:帐号=9;a.sta:状态;a.type:房类;a.roomno:房号;b.name:姓名=30;a.arr:到日=12=yy/mm/dd hh|mm;a.dep:离日=12=yy/mm/dd hh|mm;mone10:房价=8=0.00;a.applicant:单位=20;a.srqs:特要=10;b.nation:国籍;a.paycode:付款;mone12:余额=8=0.00headerds=[header=4 player=3 summary=1 styles=box]computes=p_yshu:string(page(),''0'')+''/''+string(pagecount(),''0''):header:3::mone12:mone12::border="0" alignment="2"!computes=c_fshu:count( a.accnt for all DISTINCT):summary:1::a.sta:a.type::alignment="2"!computes=c_rshu:count( a.accnt ):summary:1::a.arr:a.arr::alignment="2"!computes=c_rate:sum( mone10 for all DISTINCT a_accnt1 ):summary:1::mone10:mone10::alignment="2" format="0.00"!computes=c_bal:sum( mone12 for all DISTINCT a_accnt1 ):summary:1::mone12:mone12::alignment="2" format="0.00"!texttext=p_hotel:#hotel#:header:1::a.accnt:mone12::border="0" alignment="2" font.height="-12" font.italic="0"!texttext=p_title:当前预定信息列表(所有):header:2::a.accnt:mone12::border="0" alignment="2" font.height="-12" font.italic="0"!texttext=p_date:打印时间 #pdate#:header:3::a.accnt:mone10::border="0" alignment="0"!texttext=p_page:页次:header:3::a.paycode:a.paycode::border="0" alignment="2"!texttext=p_fshu:房数:summary:1::a.accnt:a.accnt::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:人数:summary:1::a.roomno:b.name::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:总房价:summary:1::a.dep:a.dep::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:余额:summary:1::a.applicant:a.paycode::border="2" alignment="2" font.height="-12" font.italic="0"!', 'F' ) 
INSERT INTO worksheet ( modu_id, window, tab_no, descript, descript1, tab_tag, sequence, colsele, coldes, colsta, colkey, genput, usedef ) VALUES ( '00', 'w_gds_master_list_res', 3, '团体＆会议', 'Group Master', '', 20, 'select rslt10  =  a.accnt,a.accnt,a.rmnum,a.roomno,a.gstno,b.name,b.name2,a.sta,char012  =  substring(a.extra,  4,  1),char013  =  substring(a.extra,  5,  1),char011  =  b.vip,numb081  =  (Select count(1) From message_leaveword Where sort = ''LWD'' And accnt=a.accnt And tag<''2''),numb082  =  (Select count(1) From message_leaveword Where sort = ''LOC'' And accnt=a.accnt And tag<''2''),char01  =  substring(a.extra,  10,  1), b.i_times,a.type,a.arr,a.dep,a.ref,char991  =  c.groupno+''/''+c.cusno,char992  =  c.agent+''/''+c.source,mone100  =  a.charge-a.credit,a.setrate,a.resno,a.packages,char15  =  a.pcrec,b.refer1 from master a, guest b, master_des c  where a.haccnt=b.no and a.class in (''G'',  ''M'') and a.accnt=c.accnt  and a.crsno like ''CRS:%'' and (1=1) order by a.arr, a.sta', 'a.accnt:帐号=10;b.name:姓名=16;b.name2:姓名2=16;a.sta:Sta;char01_1=='''':-;char01_2=='''':-;char01_3=='''':-;char01_4=='''':-;char01_5=='''':-;char01_6=='''':-;a.rmnum:房数=2=0=alignment="2";a.gstno:人数=3=0=alignment="2";a.setrate:房价=6=0.00=color="0~tif(nodispchar013=''1'',255,0)";a.packages:包价=7;a.arr:到达=13=yy/mm/dd hh|mm=alignment=''2'';a.dep:离开=13=yy/mm/dd hh|mm=alignment=''2'';a.resno:预订号=9=[general]=alignment=''2'';mone100:余额=8=0.00=color="0~tif(mone100>0,255,0)";char991:团体/单位=26;char992:旅行社/订房中心=26;b.refer1:喜好=20;a.ref:备注=30headerds=[footer=1 autoappe=0]computes=c_fshu:( sum( a_rmnum2 * if( a_roomno3 ='''', 1, 0))+count( a_roomno3 for all distinct ) - if((sum( a_rmnum2 * if( a_roomno3 ='''', 1, 0)))>0, 1, 0) ):footer:1::a.type:a.type::alignment="2"!computes=c_rshu:( sum( a_gstno4) ):footer:1::a.gstno:a.gstno::alignment="2"!texttext=r_vip:●:detail:1::char01_1:char01_1::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-7" color="255" visible="0~tif(nodispchar011>''0'',1,0)"!texttext=r_srt:●:detail:1::char01_2:char01_2::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-7" color="16711935" visible="1~tif(nodispchar012>''0'',1,0)"!texttext=r_msg:●:detail:1::char01_3:char01_3::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-7" color="16711680" visible="1~tif(nodispnumb081>0,1,0)"!texttext=r_link:●:detail:1::char01_4:char01_4::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-7" color="65535" visible="1~tif(trim(nodispchar15)<>'''',1,0)"!texttext=r_fwd:●:detail:1::char01_5:char01_5::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-7" color="8388608" visible="1~tif(nodispnumb082>0,1,0)"!texttext=r_lock:●:detail:1::char01_6:char01_6::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-7" color="65280~tif(nodispchar01=''1'',65280,if(nodispchar01=''2'',32768,0))" visible="1~tif(nodispchar01=''0'',0,1)"!', 'a.sta', 'rslt10', '_com_p_当前预定信息列表;(select a.accnt,a.sta,a.type,a.roomno,b.name,a.arr,a.dep,mone10  =  a.setrate,a.applicant,a.srqs,b.nation,a.paycode,mone12  =  a.charge - a.credit  from master a,guest b where a.haccnt=b.no and a.sta = ''R'' and a.class=''F'' and a.groupno=''''  and a.crsno like ''CRS:%'' order by a.accnt);a.accnt:帐号=9;a.sta:状态;a.type:房类;a.roomno:房号;b.name:姓名=30;a.arr:到日=12=yy/mm/dd hh|mm;a.dep:离日=12=yy/mm/dd hh|mm;mone10:房价=8=0.00;a.applicant:单位=20;a.srqs:特要=10;b.nation:国籍;a.paycode:付款;mone12:余额=8=0.00headerds=[header=4 player=3 summary=1 styles=box]computes=p_yshu:string(page(),''0'')+''/''+string(pagecount(),''0''):header:3::mone12:mone12::border="0" alignment="2"!computes=c_fshu:count( a.accnt for all DISTINCT):summary:1::a.sta:a.type::alignment="2"!computes=c_rshu:count( a.accnt ):summary:1::a.arr:a.arr::alignment="2"!computes=c_rate:sum( mone10 for all DISTINCT a_accnt1 ):summary:1::mone10:mone10::alignment="2" format="0.00"!computes=c_bal:sum( mone12 for all DISTINCT a_accnt1 ):summary:1::mone12:mone12::alignment="2" format="0.00"!texttext=p_hotel:#hotel#:header:1::a.accnt:mone12::border="0" alignment="2" font.height="-12" font.italic="0"!texttext=p_title:当前预定信息列表(散客):header:2::a.accnt:mone12::border="0" alignment="2" font.height="-12" font.italic="0"!texttext=p_date:打印时间 #pdate#:header:3::a.accnt:mone10::border="0" alignment="0"!texttext=p_page:页次:header:3::a.paycode:a.paycode::border="0" alignment="2"!texttext=p_fshu:房数:summary:1::a.accnt:a.accnt::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:人数:summary:1::a.roomno:b.name::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:总房价:summary:1::a.dep:a.dep::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:余额:summary:1::a.applicant:a.paycode::border="2" alignment="2" font.height="-12" font.italic="0"!', 'F' ) 
INSERT INTO worksheet ( modu_id, window, tab_no, descript, descript1, tab_tag, sequence, colsele, coldes, colsta, colkey, genput, usedef ) VALUES ( '00', 'w_gds_master_list_res', 4, 'ＶＩＰ', 'ＶＩＰ', 'b.vip>''0''', 30, '', '', '', '', '_com_p_当前预定信息列表;(select a.accnt,a.sta,a.type,a.roomno,b.name,a.arr,a.dep,mone10  =  a.setrate,a.applicant,a.srqs,b.nation,a.paycode,mone12  =  a.charge - a.credit  from master a,guest b where a.haccnt=b.no and a.sta = ''R'' and a.class=''F'' and a.groupno<>''''  and a.crsno like ''CRS:%'' order by a.accnt);a.accnt:帐号=9;a.sta:状态;a.type:房类;a.roomno:房号;b.name:姓名=30;a.arr:到日=12=yy/mm/dd hh|mm;a.dep:离日=12=yy/mm/dd hh|mm;mone10:房价=8=0.00;a.applicant:单位=20;a.srqs:特要=10;b.nation:国籍;a.paycode:付款;mone12:余额=8=0.00headerds=[header=4 player=3 summary=1 styles=box]computes=p_yshu:string(page(),''0'')+''/''+string(pagecount(),''0''):header:3::mone12:mone12::border="0" alignment="2"!computes=c_fshu:count( a.accnt for all DISTINCT):summary:1::a.sta:a.type::alignment="2"!computes=c_rshu:count( a.accnt ):summary:1::a.arr:a.arr::alignment="2"!computes=c_rate:sum( mone10 for all DISTINCT a_accnt1 ):summary:1::mone10:mone10::alignment="2" format="0.00"!computes=c_bal:sum( mone12 for all DISTINCT a_accnt1 ):summary:1::mone12:mone12::alignment="2" format="0.00"!texttext=p_hotel:#hotel#:header:1::a.accnt:mone12::border="0" alignment="2" font.height="-12" font.italic="0"!texttext=p_title:当前预定信息列表(成员):header:2::a.accnt:mone12::border="0" alignment="2" font.height="-12" font.italic="0"!texttext=p_date:打印时间 #pdate#:header:3::a.accnt:mone10::border="0" alignment="0"!texttext=p_page:页次:header:3::a.paycode:a.paycode::border="0" alignment="2"!texttext=p_fshu:房数:summary:1::a.accnt:a.accnt::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:人数:summary:1::a.roomno:b.name::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:总房价:summary:1::a.dep:a.dep::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:余额:summary:1::a.applicant:a.paycode::border="2" alignment="2" font.height="-12" font.italic="0"!', 'F' ) 
;

delete from worksta where window = 'w_gds_master_list_res'
;

;

delete from worksta_name where window = 'w_gds_master_list_res'
;

INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', '', '所有', 'All', 'T', 0 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', '''I''', '在住', 'C/I', 'F', 10 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', '''R'',''C'',''G''', '预订', 'Resrv.', 'F', 20 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', '''O''', '本日结帐', 'Today C/O', 'F', 30 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', '''D''', '昨日结帐', 'Last C/O', 'F', 40 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', '''X''', '取消', 'Cancellation', 'F', 50 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', '''N''', 'NO-SHOW', 'No-show', 'F', 60 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', '''S''', '挂帐', 'Suspend', 'F', 70 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', '''L'',''E''', '其他', 'Other', 'F', 80 ) 
;

delete from workbutton where window = 'w_gds_master_list_res'
;

INSERT INTO workbutton ( window, modu_id, tab_no, event ) VALUES ( 'w_gds_master_list_res', '00', 0, 'ue_bill_res' ) 
INSERT INTO workbutton ( window, modu_id, tab_no, event ) VALUES ( 'w_gds_master_list_res', '00', 0, 'ue_open' ) 
INSERT INTO workbutton ( window, modu_id, tab_no, event ) VALUES ( 'w_gds_master_list_res', '00', 0, 'ue_profile' ) 
;

delete from workbutton_name where window = 'w_gds_master_list_res'
;

INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', 'ue_open', '打开', 'Open', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', 'ue_account', '账务处理', 'Billing', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', 'ue_posting', '入帐', 'Posting', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', 'ue_profile', '档案', 'Profile', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', 'ue_master', '主单', 'Reservation', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', 'ue_bill_accnt', '打印账单', 'Info Copy', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', 'ue_locksta', '允许记账', 'Auth. Post', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', 'ue_fixchg', '固定支出', 'Fixed charges', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', 'ue_routing', '定义账户', 'Routing', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', 'ue_interface', '接口', 'Interface', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', 'ue_link', '联房', 'Party', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', 'ue_newr', '新预订', 'New Resrv.', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res', 'ue_bill_res', '打印单据', 'Print Folio', 'T', 10 ) 
;

delete from workselect where modu_id = 'ZZ' and window = 'w_gds_master_list_res_cen'
;

INSERT INTO workselect ( modu_id, window, descript, descript1, colsele, coldes, colsta, colkey, genput, usedef, openflash ) VALUES ( 'ZZ', 'w_gds_master_list_res_cen', '当前预订列表', '当前预订列表_eng', 'select a.hotelid,h.descript,rslt10  =  a.accnt,a.accnt,a.rmnum,a.roomno,a.gstno,b.name,b.name2,a.sta,char012  =  substring(a.extra,  4,  1),char013  =  substring(a.extra,  5,  1),char011  =  b.vip,numb081  =  (SELECT count(1) FROM message_leaveword WHERE sort = ''LWD'' And accnt=a.accnt And tag<''2''),numb082  =  (SELECT count(1) FROM message_leaveword WHERE sort = ''LOC'' And accnt=a.accnt And tag=''1'' and datediff(second,  message_leaveword.abate,  getdate()) < 0),char01  =  substring(a.extra,  10,  1),b.i_times,a.type,a.arr,a.dep,a.ref,char991  =  c.groupno+''/''+c.cusno+''/''+substring(c.unit,  1,  20),char992  =  c.agent+''/''+c.source,mone100  =  a.charge-a.credit,a.setrate,a.resno,a.packages,char15  =  a.pcrec,b.refer1 from vmaster a,guest b,master_des c,hotelinfo h  where a.haccnt=b.no and a.hotelid = h.hotelid and a.class in (''F'',  ''G'',  ''M'') and a.accnt=c.accnt and (1=1) order by a.arr,a.sta', 'h.descript:酒店=20;a.roomno:房号=3=[general];a.type:房类;a.rmnum:#=2=0=alignment="2";b.name:姓名=10;b.name2:姓名2=10;a.sta:Sta;char01_1=='''':-;char01_2=='''':-;char01_3=='''':-;char01_4=='''':-;char01_5=='''':-;char01_6=='''':-;b.i_times:次数=3=0=alignment="2";a.gstno:人数=3=0=alignment="2";a.setrate:房价=6=0.00=color="0~tif(nodispchar013=''1'',255,0)";a.packages:包价=7;a.arr:到达=13=yy/mm/dd hh|mm=alignment=''2'';a.dep:离开=13=yy/mm/dd hh|mm=alignment=''2'';a.resno:预订号=9=[general]=alignment=''2'';mone100:余额=8=0.00=color="0~tif(mone100>0,255,0)";char991:团体/单位=26;char992:旅行社/订房中心=26;b.refer1:喜好=20;a.ref:备注=30;a.accnt:帐号=10headerds=[footer=1 autoappe=0]computes=c_fshu:( sum( a_rmnum4 * if( a_roomno5 ='''', 1, 0))+count( a_roomno5 for all distinct ) - if((sum( a_rmnum4 * if( a_roomno5 ='''', 1, 0)))>0, 1, 0) ):footer:1::a.type:a.type::alignment="2"!computes=c_rshu:( sum( a_gstno6) ):footer:1::a.gstno:a.gstno::alignment="2"!texttext=r_vip:●:detail:1::char01_1:char01_1::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-13" color="255" visible="0~tif(nodispchar011>''0'',1,0)"!texttext=r_srt:●:detail:1::char01_2:char01_2::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-13" color="16711935" visible="1~tif(nodispchar012>''0'',1,0)"!texttext=r_msg:●:detail:1::char01_3:char01_3::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-13" color="16711680" visible="1~tif(nodispnumb081>0,1,0)"!texttext=r_link:●:detail:1::char01_4:char01_4::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-13" color="65535" visible="1~tif(trim(nodispchar15)<>'''',1,0)"!texttext=r_fwd:●:detail:1::char01_5:char01_5::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-13" color="8388608" visible="1~tif(nodispnumb082>0,1,0)"!texttext=r_lock:●:detail:1::char01_6:char01_6::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-13" color="65280~tif(nodispchar01=''1'',65280,if(nodispchar01=''2'',32768,0))" visible="1~tif(nodispchar01=''0'',0,1)"!', 'a.sta', 'rslt10', '_com_p_当前宾客信息列表;(select a.hotelid,h.descript,a.accnt,a.rmnum,a.roomno,a.gstno,b.name,a.sta,char012  =  substring(a.extra,  4,  1),char013  =  substring(a.extra,  5,  1),char011  =  b.vip,numb081  =  (Select count(1) From message_leaveword Where sort = ''LWD'' And accnt=a.accnt And tag<''2''),numb082  =  (Select count(1) From message_leaveword Where sort = ''LOC'' And accnt=a.accnt And tag<''2''),numb083  =  (Select count(1) From subaccnt Where accnt=a.accnt And type=''0'' And pccodes like ''+[^0]''), b.i_times,a.type,a.arr,a.dep,a.ref,c.cusno,c.agent,c.source,c.groupno,mone100  =  a.charge-a.credit,a.setrate,a.resno,a.packages,b.refer1 from vmaster a, guest b, master_des c,hotelinfo h  where a.haccnt=b.no and a.hotelid=h.hotelid and a.class in (''F'',  ''G'',  ''M'') and a.accnt=c.accnt  and a.crsno like ''CRS:%'' and (1=1));h.descript:酒店=20;a.accnt:帐号=10;b.name:姓名=10;a.sta:STA;char01_1=='''':-;char01_2=='''':-;char01_3=='''':-;char01_4=='''':-;char01_5=='''':-;char01_6=='''':-;b.i_times:次数=3;a.type:房类;a.rmnum:房数=3=0=alignment="2";a.roomno:房号=3=[general];a.gstno:人数=4=0=alignment="2";a.setrate:房价=6=0.00=color="0~tif(nodispchar013=''1'',255,0)";a.arr:ARR=13=yy/mm/dd hh|mm=alignment=''2'';a.dep:DEP=13=yy/mm/dd hh|mm=alignment=''2'';c.groupno:团体会议=12;mone100:余额=8=0.00=color="0~tif(mone100>0,255,0)";a.resno:预订号=9=[general]=alignment=''2'';a.packages:包价=12;c.cusno:单位=16;c.agent:旅行社=16;c.source:订房中心=16;b.refer1:喜好=20;a.ref:备注=30headerds=[header=4 footer=1 player=3 autoappe=0]computes=p_yshu:''页次('' + string(page(),''0'')+''/''+string(pagecount(),''0)''):header:3::a.ref:a.ref::alignment="2"!computes=c_fshu:( sum( a_rmnum2 * if( a_roomno3 ='''', 1, 0))+count( a_roomno3 for all distinct ) - if((sum( a_rmnum2 * if( a_roomno3 ='''', 1, 0)))>0, 1, 0) ):footer:1::a.rmnum:a.rmnum::alignment="2"!computes=c_rshu:( sum( a_gstno4) ):footer:1::a.gstno:a.gstno::alignment="2"!texttext=r_vip:●:detail:1::char01_1:char01_1::alignment="2" border="0" font.italic="0" font.face="Arial" font.charset="0" font.height="-10" color="255" visible="0~tif(nodispchar011>''0'',1,0)"!texttext=r_srt:●:detail:1::char01_2:char01_2::alignment="2" border="0" font.italic="0" font.face="Arial" font.charset="0" font.height="-10" color="16711935" visible="1~tif(nodispchar012>''0'',1,0)"!texttext=r_msg:●:detail:1::char01_3:char01_3::alignment="2" border="0" font.italic="0" font.face="Arial" font.charset="0" font.height="-10" color="16711680" visible="1~tif(nodispnumb081>0,1,0)"!texttext=r_fwd:●:detail:1::char01_5:char01_5::alignment="2" border="0" font.italic="0" font.face="Arial" font.charset="0" font.height="-10" color="8388608" visible="1~tif(nodispnumb082>0,1,0)"!texttext=r_lock:●:detail:1::char01_6:char01_6::alignment="2" border="0" font.italic="0" font.face="Arial" font.charset="0" font.height="-10" color="65280" visible="1~tif(nodispnumb083=0,1,0)"!texttext=t_hotel:#hotel#:header:1::h.descript:a.ref::alignment="2" font.height="-12" border="0"!texttext=t_title:宾客信息列表:header:2::h.descript:a.ref::alignment="2" font.height="-12" border="0"!texttext=t_print:打印时间 #pdate#:header:3::h.descript:a.type::alignment="0"!', 'F', 'T' ) 
;

delete from worksheet where modu_id = 'ZZ' and window = 'w_gds_master_list_res_cen'
;

INSERT INTO worksheet ( modu_id, window, tab_no, descript, descript1, tab_tag, sequence, colsele, coldes, colsta, colkey, genput, usedef ) VALUES ( 'ZZ', 'w_gds_master_list_res_cen', 1, '散客＆成员', 'Individual', 'a.class=''F''', 10, '', '', '', '', '_com_p_当前预定信息列表;(select h.descript,a.accnt,a.sta,a.type,a.roomno,b.name,a.arr,a.dep,mone10  =  a.setrate,a.applicant,a.srqs,b.nation,a.paycode,mone12  =  a.charge - a.credit  from vmaster a,guest b,hotelinfo h where a.haccnt=b.no and a.hotelid = h.hotelid  and a.sta = ''R'' and a.class=''F''  order by a.accnt );h.descript:酒店=20;a.accnt:帐号=9;a.sta:状态;a.type:房类;a.roomno:房号;b.name:姓名=30;a.arr:到日=12=yy/mm/dd hh|mm;a.dep:离日=12=yy/mm/dd hh|mm;mone10:房价=8=0.00;a.applicant:单位=20;a.srqs:特要=10;b.nation:国籍;a.paycode:付款;mone12:余额=8=0.00headerds=[header=4 player=3 summary=1 styles=box]computes=p_yshu:string(page(),''0'')+''/''+string(pagecount(),''0''):header:3::mone12:mone12::border="0" alignment="2"!computes=c_fshu:count( a.accnt for all DISTINCT):summary:1::a.sta:a.type::alignment="2"!computes=c_rshu:count( a.accnt ):summary:1::a.arr:a.arr::alignment="2"!computes=c_rate:sum( mone10 for all DISTINCT a_accnt1 ):summary:1::mone10:mone10::alignment="2" format="0.00"!computes=c_bal:sum( mone12 for all DISTINCT a_accnt1 ):summary:1::mone12:mone12::alignment="2" format="0.00"!texttext=p_hotel:#hotel#:header:1::h.descript:mone12::border="0" alignment="2" font.height="-12" font.italic="0"!texttext=p_title:当前预定信息列表(散客):header:2::h.descript:mone12::border="0" alignment="2" font.height="-12" font.italic="0"!texttext=p_date:打印时间 #pdate#:header:3::h.descript:mone10::border="0" alignment="0"!texttext=p_page:页次:header:3::a.paycode:a.paycode::border="0" alignment="2"!texttext=p_fshu:房数:summary:1::h.descript:a.accnt::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:人数:summary:1::a.roomno:b.name::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:总房价:summary:1::a.dep:a.dep::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:余额:summary:1::a.applicant:a.paycode::border="2" alignment="2" font.height="-12" font.italic="0"!', 'F' ) 
INSERT INTO worksheet ( modu_id, window, tab_no, descript, descript1, tab_tag, sequence, colsele, coldes, colsta, colkey, genput, usedef ) VALUES ( 'ZZ', 'w_gds_master_list_res_cen', 2, '所有', 'All', '1=1', 200, '', '', '', '', '_com_p_当前预定信息列表;(select h.descript,a.accnt,a.sta,a.type,a.roomno,b.name,a.arr,a.dep,mone10  =  a.setrate,a.applicant,a.srqs,b.nation,a.paycode,mone12  =  a.charge - a.credit  from vmaster a,guest b,hotelinfo h where a.haccnt=b.no and a.hotelid = h.hotelid  and a.sta = ''R'' order by a.accnt );h.descript:酒店=20;a.accnt:帐号=9;a.sta:状态;a.type:房类;a.roomno:房号;b.name:姓名=30;a.arr:到日=12=yy/mm/dd hh|mm;a.dep:离日=12=yy/mm/dd hh|mm;mone10:房价=8=0.00;a.applicant:单位=20;a.srqs:特要=10;b.nation:国籍;a.paycode:付款;mone12:余额=8=0.00headerds=[header=4 player=3 summary=1 styles=box]computes=p_yshu:string(page(),''0'')+''/''+string(pagecount(),''0''):header:3::mone12:mone12::border="0" alignment="2"!computes=c_fshu:count( a.accnt for all DISTINCT):summary:1::a.sta:a.type::alignment="2"!computes=c_rshu:count( a.accnt ):summary:1::a.arr:a.arr::alignment="2"!computes=c_rate:sum( mone10 for all DISTINCT a_accnt1 ):summary:1::mone10:mone10::alignment="2" format="0.00"!computes=c_bal:sum( mone12 for all DISTINCT a_accnt1 ):summary:1::mone12:mone12::alignment="2" format="0.00"!texttext=p_hotel:#hotel#:header:1::h.descript:mone12::border="0" alignment="2" font.height="-12" font.italic="0"!texttext=p_title:当前预定信息列表(所有):header:2::h.descript:mone12::border="0" alignment="2" font.height="-12" font.italic="0"!texttext=p_date:打印时间 #pdate#:header:3::h.descript:mone10::border="0" alignment="0"!texttext=p_page:页次:header:3::a.paycode:a.paycode::border="0" alignment="2"!texttext=p_fshu:房数:summary:1::h.descript:a.accnt::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:人数:summary:1::a.roomno:b.name::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:总房价:summary:1::a.dep:a.dep::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:余额:summary:1::a.applicant:a.paycode::border="2" alignment="2" font.height="-12" font.italic="0"!', 'F' ) 
INSERT INTO worksheet ( modu_id, window, tab_no, descript, descript1, tab_tag, sequence, colsele, coldes, colsta, colkey, genput, usedef ) VALUES ( 'ZZ', 'w_gds_master_list_res_cen', 3, '团体＆会议', 'Group Master', '', 20, 'select a.hotelid,h.descript,rslt10  =  a.accnt,a.accnt,a.rmnum,a.roomno,a.gstno,b.name,b.name2,a.sta,char012  =  substring(a.extra,  4,  1),char013  =  substring(a.extra,  5,  1),char011  =  b.vip,numb081  =  (Select count(1) From message_leaveword Where sort = ''LWD'' And accnt=a.accnt And tag<''2''),numb082  =  (Select count(1) From message_leaveword Where sort = ''LOC'' And accnt=a.accnt And tag<''2''),char01  =  substring(a.extra,  10,  1), b.i_times,a.type,a.arr,a.dep,a.ref,char991  =  c.groupno+''/''+c.cusno,char992  =  c.agent+''/''+c.source,mone100  =  a.charge-a.credit,a.setrate,a.resno,a.packages,char15  =  a.pcrec,b.refer1 from vmaster a, guest b, master_des c,hotelinfo h  where a.haccnt=b.no and a.hotelid = h.hotelid and a.class in (''G'',  ''M'') and a.accnt=c.accnt  and (1=1) order by a.arr, a.sta', 'h.descript:酒店=20;a.accnt:帐号=10;b.name:姓名=16;b.name2:姓名2=16;a.sta:Sta;char01_1=='''':-;char01_2=='''':-;char01_3=='''':-;char01_4=='''':-;char01_5=='''':-;char01_6=='''':-;a.rmnum:房数=2=0=alignment="2";a.gstno:人数=3=0=alignment="2";a.setrate:房价=6=0.00=color="0~tif(nodispchar013=''1'',255,0)";a.packages:包价=7;a.arr:到达=13=yy/mm/dd hh|mm=alignment=''2'';a.dep:离开=13=yy/mm/dd hh|mm=alignment=''2'';a.resno:预订号=9=[general]=alignment=''2'';mone100:余额=8=0.00=color="0~tif(mone100>0,255,0)";char991:团体/单位=26;char992:旅行社/订房中心=26;b.refer1:喜好=20;a.ref:备注=30headerds=[footer=1 autoappe=0]computes=c_fshu:( sum( a_rmnum4 * if( a_roomno5 ='''', 1, 0))+count( a_roomno5 for all distinct ) - if((sum( a_rmnum4 * if( a_roomno5 ='''', 1, 0)))>0, 1, 0) ):footer:1::a.type:a.type::alignment="2"!computes=c_rshu:( sum( a_gstno6) ):footer:1::a.gstno:a.gstno::alignment="2"!texttext=r_vip:●:detail:1::char01_1:char01_1::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-7" color="255" visible="0~tif(nodispchar011>''0'',1,0)"!texttext=r_srt:●:detail:1::char01_2:char01_2::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-7" color="16711935" visible="1~tif(nodispchar012>''0'',1,0)"!texttext=r_msg:●:detail:1::char01_3:char01_3::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-7" color="16711680" visible="1~tif(nodispnumb081>0,1,0)"!texttext=r_link:●:detail:1::char01_4:char01_4::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-7" color="65535" visible="1~tif(trim(nodispchar15)<>'''',1,0)"!texttext=r_fwd:●:detail:1::char01_5:char01_5::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-7" color="8388608" visible="1~tif(nodispnumb082>0,1,0)"!texttext=r_lock:●:detail:1::char01_6:char01_6::alignment="2" border="0" font.italic="0" font.face="ms serif" font.charset="0" font.height="-7" color="65280~tif(nodispchar01=''1'',65280,if(nodispchar01=''2'',32768,0))" visible="1~tif(nodispchar01=''0'',0,1)"!', 'a.sta', 'rslt10', '_com_p_当前预定信息列表;(select h.descript,a.accnt,a.sta,a.type,a.roomno,b.name,a.arr,a.dep,mone10  =  a.setrate,a.applicant,a.srqs,b.nation,a.paycode,mone12  =  a.charge - a.credit  from vmaster a,guest b,hotelinfo h where a.haccnt=b.no and a.hotelid = h.hotelid  and a.sta = ''R'' and a.class in (''G'',  ''M'')  order by a.accnt );h.descript:酒店=20;a.accnt:帐号=9;a.sta:状态;a.type:房类;a.roomno:房号;b.name:姓名=30;a.arr:到日=12=yy/mm/dd hh|mm;a.dep:离日=12=yy/mm/dd hh|mm;mone10:房价=8=0.00;a.applicant:单位=20;a.srqs:特要=10;b.nation:国籍;a.paycode:付款;mone12:余额=8=0.00headerds=[header=4 player=3 summary=1 styles=box]computes=p_yshu:string(page(),''0'')+''/''+string(pagecount(),''0''):header:3::mone12:mone12::border="0" alignment="2"!computes=c_fshu:count( a.accnt for all DISTINCT):summary:1::a.sta:a.type::alignment="2"!computes=c_rshu:count( a.accnt ):summary:1::a.arr:a.arr::alignment="2"!computes=c_rate:sum( mone10 for all DISTINCT a_accnt1 ):summary:1::mone10:mone10::alignment="2" format="0.00"!computes=c_bal:sum( mone12 for all DISTINCT a_accnt1 ):summary:1::mone12:mone12::alignment="2" format="0.00"!texttext=p_hotel:#hotel#:header:1::h.descript:mone12::border="0" alignment="2" font.height="-12" font.italic="0"!texttext=p_title:当前预定信息列表(团队):header:2::h.descript:mone12::border="0" alignment="2" font.height="-12" font.italic="0"!texttext=p_date:打印时间 #pdate#:header:3::h.descript:mone10::border="0" alignment="0"!texttext=p_page:页次:header:3::a.paycode:a.paycode::border="0" alignment="2"!texttext=p_fshu:房数:summary:1::h.descript:a.accnt::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:人数:summary:1::a.roomno:b.name::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:总房价:summary:1::a.dep:a.dep::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:余额:summary:1::a.applicant:a.paycode::border="2" alignment="2" font.height="-12" font.italic="0"!', 'F' ) 
INSERT INTO worksheet ( modu_id, window, tab_no, descript, descript1, tab_tag, sequence, colsele, coldes, colsta, colkey, genput, usedef ) VALUES ( 'ZZ', 'w_gds_master_list_res_cen', 4, 'ＶＩＰ', 'ＶＩＰ', 'b.vip>''0''', 30, '', '', '', '', '_com_p_当前预定信息列表;(select h.descript,a.accnt,a.sta,a.type,a.roomno,b.name,a.arr,a.dep,mone10  =  a.setrate,a.applicant,a.srqs,b.nation,a.paycode,mone12  =  a.charge - a.credit  from vmaster a,guest b,hotelinfo h where a.haccnt=b.no and a.hotelid = h.hotelid  and a.sta = ''R'' and b.vip >''0''  order by a.accnt );h.descript:酒店=20;a.accnt:帐号=9;a.sta:状态;a.type:房类;a.roomno:房号;b.name:姓名=30;a.arr:到日=12=yy/mm/dd hh|mm;a.dep:离日=12=yy/mm/dd hh|mm;mone10:房价=8=0.00;a.applicant:单位=20;a.srqs:特要=10;b.nation:国籍;a.paycode:付款;mone12:余额=8=0.00headerds=[header=4 player=3 summary=1 styles=box]computes=p_yshu:string(page(),''0'')+''/''+string(pagecount(),''0''):header:3::mone12:mone12::border="0" alignment="2"!computes=c_fshu:count( a.accnt for all DISTINCT):summary:1::a.sta:a.type::alignment="2"!computes=c_rshu:count( a.accnt ):summary:1::a.arr:a.arr::alignment="2"!computes=c_rate:sum( mone10 for all DISTINCT a_accnt1 ):summary:1::mone10:mone10::alignment="2" format="0.00"!computes=c_bal:sum( mone12 for all DISTINCT a_accnt1 ):summary:1::mone12:mone12::alignment="2" format="0.00"!texttext=p_hotel:#hotel#:header:1::h.descript:mone12::border="0" alignment="2" font.height="-12" font.italic="0"!texttext=p_title:当前预定信息列表(VIP):header:2::h.descript:mone12::border="0" alignment="2" font.height="-12" font.italic="0"!texttext=p_date:打印时间 #pdate#:header:3::h.descript:mone10::border="0" alignment="0"!texttext=p_page:页次:header:3::a.paycode:a.paycode::border="0" alignment="2"!texttext=p_fshu:房数:summary:1::h.descript:a.accnt::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:人数:summary:1::a.roomno:b.name::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:总房价:summary:1::a.dep:a.dep::border="2" alignment="2" font.height="-12" font.italic="0"!texttext=p_rshu:余额:summary:1::a.applicant:a.paycode::border="2" alignment="2" font.height="-12" font.italic="0"!', 'F' ) 
;

delete from worksta where window = 'w_gds_master_list_res_cen'
;

;

delete from worksta_name where window = 'w_gds_master_list_res_cen'
;

INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', '', '所有', 'All', 'T', 0 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', '''D''', '昨日结帐', 'Last C/O', 'F', 40 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', '''I''', '在住', 'C/I', 'F', 10 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', '''L'',''E''', '其他', 'Other', 'F', 80 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', '''N''', 'NO-SHOW', 'No-show', 'F', 60 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', '''O''', '本日结帐', 'Today C/O', 'F', 30 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', '''R'',''C'',''G''', '预订', 'Resrv.', 'F', 20 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', '''S''', '挂帐', 'Suspend', 'F', 70 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', '''X''', '取消', 'Cancellation', 'F', 50 ) 
;

delete from workbutton where window = 'w_gds_master_list_res_cen'
;

INSERT INTO workbutton ( window, modu_id, tab_no, event ) VALUES ( 'w_gds_master_list_res_cen', 'ZZ', 0, 'ue_bill_res' ) 
INSERT INTO workbutton ( window, modu_id, tab_no, event ) VALUES ( 'w_gds_master_list_res_cen', 'ZZ', 0, 'ue_open' ) 
INSERT INTO workbutton ( window, modu_id, tab_no, event ) VALUES ( 'w_gds_master_list_res_cen', 'ZZ', 0, 'ue_profile' ) 
;

delete from workbutton_name where window = 'w_gds_master_list_res_cen'
;

INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', 'ue_account', '账务处理', 'Billing', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', 'ue_bill_accnt', '打印账单', 'Info Copy', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', 'ue_bill_res', '打印单据', 'Print Folio', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', 'ue_fixchg', '固定支出', 'Fixed charges', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', 'ue_interface', '接口', 'Interface', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', 'ue_link', '联房', 'Party', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', 'ue_locksta', '允许记账', 'Auth. Post', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', 'ue_master', '主单', 'Reservation', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', 'ue_newr', '新预订', 'New Resrv.', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', 'ue_open', '打开', 'Open', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', 'ue_posting', '入帐', 'Posting', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', 'ue_profile', '档案', 'Profile', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_master_list_res_cen', 'ue_routing', '定义账户', 'Routing', 'T', 10 ) 
;

delete from workselect where modu_id = '00' and window = 'w_gds_hmaster_list_member'
;

INSERT INTO workselect ( modu_id, window, descript, descript1, colsele, coldes, colsta, colkey, genput, usedef, openflash ) VALUES ( '00', 'w_gds_hmaster_list_member', 'CRS-M宾客历史住店列表', 'CRS-M宾客历史住店列表_eng', 'select a.accnt,b.name,a.sta,b.vip,a.type,a.rmnum,a.roomno,a.arr,a.dep,a.ref,a.charge,a.setrate,mone10  =  isnull((Select sum(c.charge-c.credit-c.archarge+c.arcredit) From transfer_log c Where c.accnt=a.accnt),  0),a.resno,a.packages from hmaster a, hguest b  where a.haccnt=b.no  and a.resno like ''CRS:%'' and (1=1) order by a.arr desc', 'a.accnt:帐号=10;b.name:姓名=10;a.sta:STA;a.type:房类;a.rmnum:房数=3;a.roomno:房号=3=[general];a.setrate:房价=6=0.00;a.arr:ARR=13=yy/mm/dd hh|mm=alignment=''2'';a.dep:DEP=13=yy/mm/dd hh|mm=alignment=''2'';a.charge:消费=8=0.00;mone10:记账未收=8=0.00;a.resno:预订号=9=[general]=alignment=''2'';a.packages:Packages=7;a.ref:备注=30headerds=[footer=1 autoappe=0]', 'a.sta', 'a_accnt1', '', 'F', 'F' ) 
;

delete from worksheet where modu_id = '00' and window = 'w_gds_hmaster_list_member'
;

INSERT INTO worksheet ( modu_id, window, tab_no, descript, descript1, tab_tag, sequence, colsele, coldes, colsta, colkey, genput, usedef ) VALUES ( '00', 'w_gds_hmaster_list_member', 1, '散客＆成员', 'Individual', 'a.class=''F''', 10, '', '', '', '', '', 'F' ) 
INSERT INTO worksheet ( modu_id, window, tab_no, descript, descript1, tab_tag, sequence, colsele, coldes, colsta, colkey, genput, usedef ) VALUES ( '00', 'w_gds_hmaster_list_member', 2, '团体＆会议', 'Group Master', 'a.class in (''G'',  ''M'')', 20, '', '', '', '', '', 'F' ) 
INSERT INTO worksheet ( modu_id, window, tab_no, descript, descript1, tab_tag, sequence, colsele, coldes, colsta, colkey, genput, usedef ) VALUES ( '00', 'w_gds_hmaster_list_member', 3, 'AR账', 'AR', 'a.class=''A''', 30, '', '', '', '', '', 'F' ) 
INSERT INTO worksheet ( modu_id, window, tab_no, descript, descript1, tab_tag, sequence, colsele, coldes, colsta, colkey, genput, usedef ) VALUES ( '00', 'w_gds_hmaster_list_member', 4, '消费账', 'House Account', 'a.class=''C''', 40, '', '', '', '', '', 'F' ) 
INSERT INTO worksheet ( modu_id, window, tab_no, descript, descript1, tab_tag, sequence, colsele, coldes, colsta, colkey, genput, usedef ) VALUES ( '00', 'w_gds_hmaster_list_member', 5, '所有', 'All', '1=1', 5, '', '', '', '', '', 'F' ) 
;

delete from worksta where window = 'w_gds_hmaster_list_member'
;

;

delete from worksta_name where window = 'w_gds_hmaster_list_member'
;

INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_hmaster_list_member', '', '所有', 'All', 'T', 5 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_hmaster_list_member', '''N''', 'NO-Show', 'No-show', 'F', 30 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_hmaster_list_member', '''O''', '结账退房', 'C/O', 'F', 10 ) 
INSERT INTO worksta_name ( window, sta, descript, descript1, show, sequence ) VALUES ( 'w_gds_hmaster_list_member', '''X''', '取消预订', 'Cancellation', 'F', 20 ) 
;

delete from workbutton where window = 'w_gds_hmaster_list_member'
;

INSERT INTO workbutton ( window, modu_id, tab_no, event ) VALUES ( 'w_gds_hmaster_list_member', '00', 0, 'ue_profile' ) 
;

delete from workbutton_name where window = 'w_gds_hmaster_list_member'
;

INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_hmaster_list_member', 'ue_account', '账务处理', 'Billing', 'T', 25 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_hmaster_list_member', 'ue_bill_accnt', '打印账单', 'Info Copy', 'T', 30 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_hmaster_list_member', 'ue_haccount', '查账', 'Account Query', 'T', 40 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_hmaster_list_member', 'ue_master', '主单', 'Reservation', 'T', 10 ) 
INSERT INTO workbutton_name ( window, event, descript, descript1, show, sequence ) VALUES ( 'w_gds_hmaster_list_member', 'ue_profile', '档案', 'Profile', 'T', 20 ) 
;

